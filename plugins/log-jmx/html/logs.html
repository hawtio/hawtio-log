<div class="log-jmx-main" ng-controller="LogsController">

  <div class="log-jmx-flex-container">
    <div class="log-jmx-fixed-toolbar">
      <h1>Log</h1>
      <p ng-show="logs.length === 0">Loading...</p>
      <div ng-show="logs.length > 0">
        <pf-toolbar config="toolbarConfig"></pf-toolbar>
        <table class="table table-striped log-jmx-header-table">
          <thead>
            <tr>
              <th>Timestamp</th>
              <th>Level</th>
              <th>Logger</th>
              <th>Message</th>
            </tr>
          </thead>
        </table>
      </div>
    </div>
    <div class="log-jmx-scrollable-table" ng-show="logs.length > 0">
      <table class="table table-striped">
        <tbody>
          <tr ng-repeat="logEntry in filteredLogs">
            <td><samp>{{logEntry | logDateFilter}}</samp></td>
            <td class="{{logEntry.levelClass}}"><samp>{{logEntry.level}}</samp></td>
            <td ng-switch="logEntry.hasLogSourceHref">
              <a href="" ng-switch-when="true" ng-click="openLogModal(logEntry)">{{logEntry.logger}}</a>
              <span ng-switch-default>{{logEntry.logger}}</span>
            </td>
            <td ng-bind-html="logEntry.sanitizedMessage | highlight:messageSearchText"></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script type="text/ng-template" id="logDetailsModal.html">
    <div class="modal-header">
      <button type="button" class="close" aria-label="Close" ng-click="$dismiss()">
        <span class="pficon pficon-close" aria-hidden="true"></span>
      </button>
      <h4 class="modal-title">Log</h4>
    </div>
    <div class="modal-body">
      <dl class="dl-horizontal">
        <dt>Timestamp</dt>
        <dd><samp>{{logEntry | logDateFilter}}</samp></dd>
        <dt>Level</dt>
        <dd class="{{logEntry.levelClass}}"><samp>{{logEntry.level}}</samp></dd>
        <dt>Logger</dt>
        <dd><samp>{{logEntry.logger}}</samp></dd>
        <div ng-show="logEntry.hasLogSourceLineHref">
          <dt>Class</dt>
          <dd><samp>{{logEntry.className}}</samp></dd>
          <dt>Method</dt>
          <dd><samp>{{logEntry.methodName}}</samp></dd>
          <dt>File</dt>
          <dd><samp>{{logEntry.fileName}}:{{logEntry.lineNumber}}</samp></dd>
        </div>
        <div ng-show="logEntry.host">
          <dt>Host</dt>
          <dd><samp>{{logEntry.host}}</samp></dd>
        </div>
        <dt>Thread</dt>
        <dd><samp>{{logEntry.thread}}</samp></dd>
        <div ng-show="logEntry.hasOSGiProps">
          <div ng-show="logEntry.properties['bundle.name']">
            <dt>Bundle Name</dt>
            <dd><samp>{{logEntry.properties['bundle.name']}}</samp></dd>
          </div>
          <div ng-show="logEntry.properties['bundle.id']">
            <dt>Bundle ID</dt>
            <dd><samp>{{logEntry.properties['bundle.id']}}</samp></dd>
          </div>
          <div ng-show="logEntry.properties['bundle.version']">
            <dt>Bundle Version</dt>
            <dd><samp>{{logEntry.properties['bundle.version']}}</samp></dd>
          </div>
        </div>
        <dt>Message</dt>
        <dd><samp>{{logEntry.sanitizedMessage}}</samp></dd>
      </dl>
      <dl ng-if="logEntry.exception">
        <dt>Stack Trace</dt>
        <dd>
          <samp>
            <ul class="list-unstyled">
              <li ng-repeat="frame in logEntry.exception" class="log-jmx-stacktrace-list-item">{{frame}}</li>
            </ul>
          </samp>
        </dd>
      </dl>
    </div>
  </script>

</div>
